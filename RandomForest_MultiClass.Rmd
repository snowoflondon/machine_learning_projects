---
title: "R Notebook"
output: html_notebook
---

```{r, eval=FALSE}
install.packages('randomForest')
library(randomForest)
library(tidyverse)

df <- read_csv('Iris.csv')
```

```{r}
head(df)
```

```{r}
summary(df)
```

```{r}
set.seed(42)
df$label <- factor(df$label)
train_subset <- sample(nrow(df), 0.8*nrow(df), replace=FALSE)
df_train <- df[train_subset,]
df_val <- df[-train_subset,]
```

```{r}
model <- randomForest(label ~ ., data = df_train, importance =T)
model
```

```{r}
df_e <- data.frame(err_rate = model$err.rate[,'OOB'], 
                      n_trees=1:model$ntree)
ggplot(df_e, aes(x=n_trees, y=err_rate)) + 
  geom_line() + 
  labs(title='OOB error rate with respect to tree growth')
```

```{r}
df_pred_val <- predict(model, df_val, type='class')
table(df_pred_val, df_val$label)
```

```{r}
mean(df_pred_val == df_val$label)
```

```{r}
importance(model)
```

```{r}
varImpPlot(model, type=1, main=NULL)
```

```{r}
varImpPlot(model, type=2, main=NULL)
```
